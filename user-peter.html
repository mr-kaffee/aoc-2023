<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<title>Solutions by peter</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="./rouge-github.css">
</head>
<body id="top" class="article toc2 toc-right">
<div style="width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em">
    <div class="paragraph">
        <a href="/index.html">AoC 2023 Solutions</a>
        &bull; <a href="https://github.com/mr-kaffee/aoc-2023/">GitHub Repository</a>
        &bull; <a href="https://adventofcode.com/2023/">Advent of Code</a>
    </div>
</div>
<div id="header">
<h1>Solutions by peter</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#sol-cpp-0">C++ | Day 0: Hello World</a>
<ul class="sectlevel2">
<li><a href="#_the_code">The code</a></li>
<li><a href="#_run_it_with_cmake">Run it with CMake</a></li>
</ul>
</li>
<li><a href="#sol-kotlin-0">Kotlin | Day 0: Hello World</a>
<ul class="sectlevel2">
<li><a href="#_the_code_2">The code</a></li>
<li><a href="#_run_it">Run it</a></li>
</ul>
</li>
<li><a href="#sol-rust-0">Rust | Day 0: Hello Ferris</a>
<ul class="sectlevel2">
<li><a href="#_general_solution_structure">General solution structure</a></li>
<li><a href="#_hello_world_implementation">Hello World implementation</a></li>
<li><a href="#_hello_world_tests">Hello World tests</a></li>
</ul>
</li>
<li><a href="#sol-haskell-1">Haskell | Day 1: Trebuchet?!</a>
<ul class="sectlevel2">
<li><a href="#_star_1">Star 1</a></li>
<li><a href="#_star_2">Star 2</a></li>
</ul>
</li>
<li><a href="#sol-rust-1">Rust | Day 1: Trebuchet?!</a>
<ul class="sectlevel2">
<li><a href="#_input">Input</a></li>
<li><a href="#_star_1_2">Star 1</a></li>
<li><a href="#_star_2_2">Star 2</a></li>
<li><a href="#_tests">Tests</a></li>
</ul>
</li>
<li><a href="#sol-haskell-2">Haskell | Day 2: Cube Conundrum</a>
<ul class="sectlevel2">
<li><a href="#_star_1_3">Star 1</a></li>
<li><a href="#_star_2_3">Star 2</a></li>
</ul>
</li>
<li><a href="#sol-rust-2">Rust | Day 2: Cube Conundrum</a>
<ul class="sectlevel2">
<li><a href="#_input_2">Input</a></li>
<li><a href="#_star_1_4">Star 1</a></li>
<li><a href="#_star_2_4">Star 2</a></li>
<li><a href="#_tests_2">Tests</a></li>
</ul>
</li>
<li><a href="#sol-rust-3">Rust | Day 3: Gear Ratios</a>
<ul class="sectlevel2">
<li><a href="#_input_3">Input</a></li>
<li><a href="#_star_1_5">Star 1</a></li>
<li><a href="#_star_2_5">Star 2</a></li>
<li><a href="#_tests_3">Tests</a></li>
</ul>
</li>
<li><a href="#sol-rust-4">Rust | Day 4: Scratchcards</a>
<ul class="sectlevel2">
<li><a href="#_input_4">Input</a></li>
<li><a href="#_star_1_6">Star 1</a></li>
<li><a href="#_star_2_6">Star 2</a></li>
<li><a href="#_tests_4">Tests</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="sol-cpp-0">C++ | Day 0: Hello World</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_the_code">The code</h3>
<div class="paragraph">
<p>This is a simple C++ template.</p>
</div>
<div class="paragraph">
<p>It reads the input in a list of lines using a <code>FileHandler</code> class implementing <em>RAII</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="code"><pre><span class="k">class</span> <span class="nc">FileHandler</span> <span class="p">{</span>
<span class="nl">public:</span>
  <span class="n">FileHandler</span><span class="p">(</span><span class="n">string</span> <span class="k">const</span> <span class="o">&amp;</span><span class="n">filename</span><span class="p">)</span> <span class="o">:</span> <span class="n">_file</span><span class="p">{</span><span class="n">filename</span><span class="p">}</span> <span class="p">{}</span>
  <span class="o">~</span><span class="n">FileHandler</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">_file</span><span class="p">.</span><span class="n">is_open</span><span class="p">())</span> <span class="p">{</span>
      <span class="n">_file</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">readLines</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">lines</span><span class="p">{};</span>
    <span class="n">string</span> <span class="n">line</span><span class="p">{};</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">getline</span><span class="p">(</span><span class="n">_file</span><span class="p">,</span> <span class="n">line</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">lines</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">lines</span><span class="p">;</span>
  <span class="p">}</span>

<span class="nl">private:</span>
  <span class="n">ifstream</span> <span class="n">_file</span><span class="p">;</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>And it does something incredibly meaningful with the input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
</pre></td><td class="code"><pre><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">auto</span> <span class="n">start</span> <span class="o">=</span> <span class="n">Clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>

  <span class="k">auto</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">FileHandler</span><span class="p">{</span><span class="s">"input00"</span><span class="p">}.</span><span class="n">readLines</span><span class="p">();</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="k">const</span> <span class="o">&amp;</span><span class="n">line</span> <span class="o">:</span> <span class="n">lines</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">line</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">Duration</span> <span class="n">d</span> <span class="o">=</span> <span class="n">Clock</span><span class="o">::</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Solved puzzle in "</span> <span class="o">&lt;&lt;</span> <span class="n">d</span><span class="p">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">DURATION_UNIT</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_run_it_with_cmake">Run it with CMake</h3>
<div class="paragraph">
<p>I use CMake and its integration in VS Code to build (<code>F7</code>) and run (<code>Shift+F5</code>) the solution with this simple <code>CMakeLists.txt</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cmake"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
</pre></td><td class="code"><pre><span class="nb">cmake_minimum_required</span><span class="p">(</span>VERSION 3.12<span class="p">)</span>

<span class="nb">set</span><span class="p">(</span>AOC_DAY <span class="s2">"00"</span><span class="p">)</span>

<span class="nb">project</span><span class="p">(</span>peter_day<span class="si">${</span><span class="nv">AOC_DAY</span><span class="si">}</span> VERSION 0.1.0<span class="p">)</span>

<span class="nb">set</span><span class="p">(</span>CMAKE_CXX_STANDARD 20<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>CMAKE_CXX_STANDARD_REQUIRED True<span class="p">)</span>

<span class="c1"># copy input to build folder</span>
<span class="nb">file</span><span class="p">(</span>COPY <span class="s2">"../../../inputs/input</span><span class="si">${</span><span class="nv">AOC_DAY</span><span class="si">}</span><span class="s2">"</span> DESTINATION <span class="s2">"</span><span class="si">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="nb">add_executable</span><span class="p">(</span>solution solution.cpp<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#top">Top</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sol-kotlin-0">Kotlin | Day 0: Hello World</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_the_code_2">The code</h3>
<div class="paragraph">
<p>This is a simple Kotlin template.</p>
</div>
<div class="paragraph">
<p>It reads the input in a list of lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
</pre></td><td class="code"><pre><span class="k">fun</span> <span class="nf">readLines</span><span class="p">():</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nc">File</span><span class="p">(</span><span class="s">"../../../inputs/input00"</span><span class="p">).</span><span class="nf">useLines</span><span class="p">()</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="nf">toList</span><span class="p">()</span> <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>And it does something incredibly meaningful with the input:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="kotlin"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
</pre></td><td class="code"><pre><span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">start</span> <span class="p">=</span> <span class="nc">System</span><span class="p">.</span><span class="nf">currentTimeMillis</span><span class="p">()</span>

    <span class="kd">val</span> <span class="py">lines</span> <span class="p">=</span> <span class="nf">readLines</span><span class="p">()</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">line</span> <span class="k">in</span> <span class="n">lines</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">val</span> <span class="py">elapsed</span> <span class="p">=</span> <span class="nc">System</span><span class="p">.</span><span class="nf">currentTimeMillis</span><span class="p">()</span> <span class="p">-</span> <span class="n">start</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Solved puzzle in ${elapsed}ms."</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_run_it">Run it</h3>
<div class="paragraph">
<p>The solutions can be run out of VS Code using the <a href="https://marketplace.visualstudio.com/items?itemName=formulahendry.code-runner">Code Runner</a> extension via the <code>Ctrl+Alt+N</code> shortcut or in the terminal using <code>kotlinc solution.kt -include-runtime -d solution.jar &amp;&amp; java -jar solution.jar</code>.</p>
</div>
<div class="paragraph">
<p><a href="#top">Top</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sol-rust-0">Rust | Day 0: Hello Ferris</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://rust-lang.org">Rust</a> <strong>Hello World</strong>, <a href="https://adventofcode.com/2023/">AoC|2023</a> starts.</p>
</div>
<div class="paragraph">
<p>It will be another year of Rust solutions for me. It is just so much fun, that I am not tempted to try another language.</p>
</div>
<div class="paragraph">
<p>I will again try to not use any external dependencies and create fast solutions.</p>
</div>
<div class="sect2">
<h3 id="_general_solution_structure">General solution structure</h3>
<div class="paragraph">
<p>The general structure of my solutions will be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>+- src
|  +- lib.rs    // the actual implementation
|  +- main.rs   // the code to run the solution
+- Cargo.toml   // cargo manifest
+- README.adoc  // documentation of the solution</code></pre>
</div>
</div>
<div class="paragraph">
<p>The solution is run using <code>cargo run</code> or <code>cargo run --release</code>. Sometimes there will be features for solution variants, that will be run with <code>cargo run --features [some feature] --release</code>.</p>
</div>
<div class="paragraph">
<p>Typically, there will also be tests which can be executed using <code>cargo test</code> or <code>cargo test --release</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_hello_world_implementation">Hello World implementation</h3>
<div class="paragraph">
<p>The implementation will typically consist of the parts detailed below.</p>
</div>
<div class="paragraph">
<p>Some meta and type information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
4
</pre></td><td class="code"><pre><span class="k">pub</span> <span class="k">const</span> <span class="n">IDENTIFIER</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span> <span class="o">=</span> <span class="s">"2023/00"</span><span class="p">;</span>

<span class="k">pub</span> <span class="k">type</span> <span class="n">InputType</span> <span class="o">=</span> <span class="nb">str</span><span class="p">;</span>
<span class="k">pub</span> <span class="k">type</span> <span class="n">Sol1Type</span> <span class="o">=</span> <span class="nb">usize</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Some code to parse the input (in this example, this also includes a simple <code>doctest</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
</pre></td><td class="code"><pre><span class="k">pub</span> <span class="k">const</span> <span class="n">FERRIS</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span> <span class="o">=</span> <span class="s">r"    _~^~^~_
\) /  o o  \ (/
  '_   ¬   _'
  \ '-----' /"</span><span class="p">;</span>

<span class="cd">/// Parse the puzzle input.</span>
<span class="cd">///</span>
<span class="cd">/// # Examples</span>
<span class="cd">/// ```</span>
<span class="cd">/// # use mr_kaffee_2023_00::*;</span>
<span class="cd">/// let input = parse_input();</span>
<span class="cd">/// assert_eq!(FERRIS, input, "Expect input to be ferris");</span>
<span class="cd">/// ```</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="nf">parse_input</span><span class="p">()</span> <span class="k">-&gt;</span> <span class="o">&amp;</span><span class="k">'static</span> <span class="nb">str</span> <span class="p">{</span>
    <span class="n">FERRIS</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The implementation of the solution functions <code>star_1</code> (and for most days <code>star_2</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
4
</pre></td><td class="code"><pre><span class="k">pub</span> <span class="k">fn</span> <span class="n">star_1</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span> <span class="nb">AsRef</span><span class="o">&lt;</span><span class="n">InputType</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">input</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="n">Sol1Type</span> <span class="p">{</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"{}"</span><span class="p">,</span> <span class="n">input</span><span class="nf">.as_ref</span><span class="p">());</span>
    <span class="mi">0</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_hello_world_tests">Hello World tests</h3>
<div class="paragraph">
<p>And there are typically some tests (mostly based on the example data given in the puzzle inputs):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="code"><pre><span class="nd">#[cfg(test)]</span>
<span class="k">mod</span> <span class="n">tests</span> <span class="p">{</span>
    <span class="k">use</span> <span class="k">super</span><span class="p">::</span><span class="o">*</span><span class="p">;</span>

    <span class="nd">#[test]</span>
    <span class="cd">/// This is a repetition of the doctest for the [`parse_input`] function.</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_parse_input</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="n">FERRIS</span><span class="p">,</span> <span class="nf">parse_input</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="nd">#[test]</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_star_1</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// the function star_1 can be called with a String ...</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">star_1</span><span class="p">(</span><span class="s">"owned"</span><span class="nf">.to_string</span><span class="p">()));</span>
        <span class="c1">// ... or with a &amp;str argument</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">star_1</span><span class="p">(</span><span class="s">"reference"</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nd">#[should_panic]</span>
    <span class="nd">#[test]</span>
    <span class="cd">/// This is an arbitrary test which is expected to panic.</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_panic</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">panic!</span><span class="p">(</span><span class="s">"This will panic!"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#top">Top</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sol-haskell-1">Haskell | Day 1: Trebuchet?!</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The solution is run with <code>runhaskell solution.hs</code> (or alternatively compiled with <code>ghc solution.hs</code> which creates an binary <code>solution</code>).</p>
</div>
<div class="sect2">
<h3 id="_star_1">Star 1</h3>
<div class="paragraph">
<p>The solution consists in summing the scores for every line.</p>
</div>
<div class="paragraph">
<p>The scores for a line are calculated in the <code>score1</code> function</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="haskell"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
</pre></td><td class="code"><pre><span class="c1">-- solution for both stars, use score1 or score2 as first argument</span>
<span class="n">star</span> <span class="o">::</span> <span class="p">(</span><span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">Int</span>
<span class="n">star</span> <span class="n">f</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">.</span> <span class="n">map</span> <span class="n">f</span> <span class="o">.</span> <span class="n">lines</span>

<span class="c1">-- scoring function for star1</span>
<span class="n">score1</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">Int</span>
<span class="n">score1</span> <span class="n">xs</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">score1'</span> <span class="n">xs</span> <span class="o">+</span> <span class="n">score1'</span> <span class="p">(</span><span class="n">reverse</span> <span class="n">xs</span><span class="p">)</span>
  <span class="kr">where</span>
    <span class="n">score1'</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">Int</span>
    <span class="n">score1'</span> <span class="p">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">xs</span><span class="p">)</span>
      <span class="o">|</span> <span class="n">isDigit</span> <span class="n">x</span> <span class="o">=</span> <span class="n">ord</span> <span class="n">x</span> <span class="o">-</span> <span class="n">ord</span> <span class="sc">'0'</span>
      <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">score1'</span> <span class="n">xs</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_star_2">Star 2</h3>
<div class="paragraph">
<p>The solution for the second star uses a <code>score2</code> function which looks for digits spelled out in addition to simple digits.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="haskell"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
</pre></td><td class="code"><pre><span class="c1">-- scoring function for star2</span>
<span class="n">score2</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">Int</span>
<span class="n">score2</span> <span class="n">xs</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">score2'</span> <span class="n">id</span> <span class="n">xs</span> <span class="o">+</span> <span class="n">score2'</span> <span class="n">reverse</span> <span class="p">(</span><span class="n">reverse</span> <span class="n">xs</span><span class="p">)</span>
  <span class="kr">where</span>
    <span class="n">score2'</span> <span class="o">::</span> <span class="p">(</span><span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">Int</span>
    <span class="n">score2'</span> <span class="n">f</span> <span class="p">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">xs</span><span class="p">)</span>
      <span class="o">|</span> <span class="n">isDigit</span> <span class="n">x</span> <span class="o">=</span> <span class="n">ord</span> <span class="n">x</span> <span class="o">-</span> <span class="n">ord</span> <span class="sc">'0'</span>
      <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="kr">case</span> <span class="n">findIndex</span> <span class="p">((`</span><span class="n">isPrefixOf</span><span class="p">`</span> <span class="p">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">xs</span><span class="p">))</span> <span class="o">.</span> <span class="n">f</span><span class="p">)</span> <span class="n">digits</span> <span class="kr">of</span>
          <span class="kt">Just</span> <span class="n">digit</span> <span class="o">-&gt;</span> <span class="n">digit</span>
          <span class="kt">Nothing</span> <span class="o">-&gt;</span> <span class="n">score2'</span> <span class="n">f</span> <span class="n">xs</span>
      <span class="kr">where</span>
        <span class="n">digits</span> <span class="o">=</span> <span class="p">[</span><span class="s">"zero"</span><span class="p">,</span> <span class="s">"one"</span><span class="p">,</span> <span class="s">"two"</span><span class="p">,</span> <span class="s">"three"</span><span class="p">,</span> <span class="s">"four"</span><span class="p">,</span> <span class="s">"five"</span><span class="p">,</span> <span class="s">"six"</span><span class="p">,</span> <span class="s">"seven"</span><span class="p">,</span> <span class="s">"eight"</span><span class="p">,</span> <span class="s">"nine"</span><span class="p">]</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#top">Top</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sol-rust-1">Rust | Day 1: Trebuchet?!</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://rust-lang.org">Rust</a> solution to <a href="https://adventofcode.com/2023/day/1">AoC|2023|1</a>.</p>
</div>
<div class="sect2">
<h3 id="_input">Input</h3>
<div class="paragraph">
<p>No separate input processing today. Just operate on the raw character data.</p>
</div>
</div>
<div class="sect2">
<h3 id="_star_1_2">Star 1</h3>
<div class="paragraph">
<p>The solution consists of two parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A <code>map_1</code> function, that returns for any <code>&amp;str</code> the value of the digit at its head wrapped in an <code>Option</code> or <code>None</code> if there is no digit.</p>
</li>
<li>
<p>A <code>score</code> function which calculates the score for a line by finding the first and last digit. The <code>map_1</code> function is passed as an argument.</p>
</li>
<li>
<p>A <code>star</code> function which calculates the solution by summing over the scores for each line. This function takes as well <code>map_1</code> as an argument.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
</pre></td><td class="code"><pre><span class="k">pub</span> <span class="k">fn</span> <span class="nf">map_1</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="n">SolT</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">b</span> <span class="o">=</span> <span class="n">line</span><span class="nf">.as_bytes</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">match</span> <span class="n">b</span> <span class="p">{</span>
        <span class="sc">b'0'</span><span class="o">..=</span><span class="sc">b'9'</span> <span class="k">=&gt;</span> <span class="nf">Some</span><span class="p">((</span><span class="n">b</span> <span class="o">-</span> <span class="sc">b'0'</span><span class="p">)</span> <span class="k">as</span> <span class="n">_</span><span class="p">),</span>
        <span class="n">_</span> <span class="k">=&gt;</span> <span class="nb">None</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="n">score</span><span class="o">&lt;</span><span class="n">F</span><span class="p">:</span> <span class="nf">Fn</span><span class="p">(</span><span class="o">&amp;</span><span class="nb">str</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="n">SolT</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">l</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">F</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="n">SolT</span> <span class="p">{</span>
    <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="n">l</span><span class="nf">.len</span><span class="p">())</span><span class="nf">.map</span><span class="p">(|</span><span class="n">k</span><span class="p">|</span> <span class="o">&amp;</span><span class="n">l</span><span class="p">[</span><span class="n">k</span><span class="o">..</span><span class="p">])</span><span class="nf">.find_map</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">()</span> <span class="o">*</span> <span class="mi">10</span>
        <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="n">l</span><span class="nf">.len</span><span class="p">())</span><span class="nf">.rev</span><span class="p">()</span><span class="nf">.map</span><span class="p">(|</span><span class="n">k</span><span class="p">|</span> <span class="o">&amp;</span><span class="n">l</span><span class="p">[</span><span class="n">k</span><span class="o">..</span><span class="p">])</span><span class="nf">.find_map</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">pub</span> <span class="k">fn</span> <span class="n">star</span><span class="o">&lt;</span><span class="n">F</span><span class="p">:</span> <span class="nf">Fn</span><span class="p">(</span><span class="o">&amp;</span><span class="nb">str</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="n">SolT</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">,</span> <span class="n">map</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">F</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="n">SolT</span> <span class="p">{</span>
    <span class="n">data</span><span class="nf">.lines</span><span class="p">()</span><span class="nf">.map</span><span class="p">(|</span><span class="n">line</span><span class="p">|</span> <span class="nf">score</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">map</span><span class="p">))</span><span class="nf">.sum</span><span class="p">()</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Catches for the 1st star:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There may be lines with only one digit. In that case, it is the first and the last digit.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_star_2_2">Star 2</h3>
<div class="paragraph">
<p>All that is needed for the second star is to extend <code>map_1</code> function to <code>map_2</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="k">const</span> <span class="n">DIGITS</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="o">&amp;</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">[</span>
    <span class="s">"zero"</span><span class="p">,</span> <span class="s">"one"</span><span class="p">,</span> <span class="s">"two"</span><span class="p">,</span> <span class="s">"three"</span><span class="p">,</span> <span class="s">"four"</span><span class="p">,</span> <span class="s">"five"</span><span class="p">,</span> <span class="s">"six"</span><span class="p">,</span> <span class="s">"seven"</span><span class="p">,</span> <span class="s">"eight"</span><span class="p">,</span> <span class="s">"nine"</span><span class="p">,</span>
<span class="p">];</span>

<span class="k">pub</span> <span class="k">fn</span> <span class="nf">map_2</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="n">SolT</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="nf">map_1</span><span class="p">(</span><span class="n">line</span><span class="p">)</span><span class="nf">.or_else</span><span class="p">(||</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="n">DIGITS</span><span class="nf">.len</span><span class="p">())</span><span class="nf">.find</span><span class="p">(|</span><span class="o">&amp;</span><span class="n">digit</span><span class="p">|</span> <span class="n">line</span><span class="nf">.starts_with</span><span class="p">(</span><span class="n">DIGITS</span><span class="p">[</span><span class="n">digit</span><span class="p">])))</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Catches for the 2nd star:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Textual representation of digits may overlap like in <strong>oneight</strong> (this is not an issue when searching from the end of the string, my initial solution just searched for all digits in a line and skipped characters belonging to one digit for the next step)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_tests">Tests</h3>
<div class="paragraph">
<p>Just check the scores for the sample data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="code"><pre><span class="nd">#[cfg(test)]</span>
<span class="k">mod</span> <span class="n">tests</span> <span class="p">{</span>
    <span class="k">use</span> <span class="k">super</span><span class="p">::</span><span class="o">*</span><span class="p">;</span>

    <span class="k">const</span> <span class="n">CONTENT_1</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span> <span class="o">=</span> <span class="s">r#"1abc2
pqr3stu8vwx
a1b2c3d4e5f
treb7uchet
"#</span><span class="p">;</span>

    <span class="nd">#[test]</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_star_1</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="mi">142</span><span class="p">,</span> <span class="nf">star</span><span class="p">(</span><span class="n">CONTENT_1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">map_1</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">const</span> <span class="n">CONTENT_2</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span> <span class="o">=</span> <span class="s">r#"two1nine
eightwothree
abcone2threexyz
xtwone3four
4nineeightseven2
zoneight234
7pqrstsixteen
"#</span><span class="p">;</span>

    <span class="nd">#[test]</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_star_2</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="mi">281</span><span class="p">,</span> <span class="nf">star</span><span class="p">(</span><span class="n">CONTENT_2</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">map_2</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#top">Top</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sol-haskell-2">Haskell | Day 2: Cube Conundrum</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I struggled a bit parsing the input.</p>
</div>
<div class="paragraph">
<p>What eventually helped was to realize, that every pair of a count and a color can be considered independently. There is no need to group them to draws with cubes of different colors. In other words: the colors can be considered independently.</p>
</div>
<div class="sect2">
<h3 id="_star_1_3">Star 1</h3>
<div class="paragraph">
<p>I have two helper functions to separate the ID from the draws and to choose one argument out of three given a color string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="haskell"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
</pre></td><td class="code"><pre><span class="c1">-- extract Game id: ...draws... into (id, ...draws...)</span>
<span class="n">splitId</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">String</span><span class="p">)</span>
<span class="n">splitId</span> <span class="n">line</span><span class="o">@</span><span class="p">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">xs</span><span class="p">)</span>
  <span class="o">|</span> <span class="n">isDigit</span> <span class="n">x</span> <span class="o">=</span> <span class="n">splitId'</span> <span class="mi">0</span> <span class="n">line</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">splitId</span> <span class="n">xs</span>
  <span class="kr">where</span>
    <span class="n">splitId'</span> <span class="o">::</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">String</span><span class="p">)</span>
    <span class="n">splitId'</span> <span class="n">id</span> <span class="p">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">xs</span><span class="p">)</span>
      <span class="o">|</span> <span class="n">isDigit</span> <span class="n">x</span> <span class="o">=</span> <span class="n">splitId'</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">id</span> <span class="o">+</span> <span class="p">(</span><span class="n">ord</span> <span class="n">x</span> <span class="o">-</span> <span class="n">ord</span> <span class="sc">'0'</span><span class="p">))</span> <span class="n">xs</span>
    <span class="n">splitId'</span> <span class="n">id</span> <span class="p">(</span><span class="sc">':'</span> <span class="o">:</span> <span class="sc">' '</span> <span class="o">:</span> <span class="n">xs</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>With this, the solution to star1 looks as follows (see explanation in the comments):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="haskell"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
</pre></td><td class="code"><pre><span class="c1">-- sum over ids of all lines which respect the limits</span>
<span class="n">star1</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">Int</span>
<span class="n">star1</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">.</span> <span class="n">map</span> <span class="n">fst</span> <span class="o">.</span> <span class="n">filter</span> <span class="p">(</span><span class="n">allSmaller</span> <span class="mi">12</span> <span class="mi">13</span> <span class="mi">14</span> <span class="o">.</span> <span class="n">words</span> <span class="o">.</span> <span class="n">snd</span><span class="p">)</span> <span class="o">.</span> <span class="n">map</span> <span class="n">splitId</span> <span class="o">.</span> <span class="n">lines</span>
  <span class="kr">where</span>
    <span class="c1">-- essentially a foldl which consumes two elements (count and color) at once</span>
    <span class="n">allSmaller</span> <span class="o">::</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
    <span class="n">allSmaller</span> <span class="kr">_</span> <span class="kr">_</span> <span class="kr">_</span> <span class="kt">[]</span> <span class="o">=</span> <span class="kt">True</span>
    <span class="n">allSmaller</span> <span class="n">r</span> <span class="n">g</span> <span class="n">b</span> <span class="p">(</span><span class="n">n</span> <span class="o">:</span> <span class="p">(</span><span class="n">c</span> <span class="o">:</span> <span class="kr">_</span><span class="p">)</span> <span class="o">:</span> <span class="n">xs</span><span class="p">)</span>
      <span class="o">|</span> <span class="n">read</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="kt">False</span>
      <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="n">allSmaller</span> <span class="n">r</span> <span class="n">g</span> <span class="n">b</span> <span class="n">xs</span>
      <span class="kr">where</span>
        <span class="n">v</span> <span class="o">=</span> <span class="kr">case</span> <span class="n">c</span> <span class="kr">of</span>
          <span class="sc">'r'</span> <span class="o">-&gt;</span> <span class="n">r</span>
          <span class="sc">'g'</span> <span class="o">-&gt;</span> <span class="n">g</span>
          <span class="sc">'b'</span> <span class="o">-&gt;</span> <span class="n">b</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_star_2_3">Star 2</h3>
<div class="paragraph">
<p>Star 2 is quite similar besides there is just mapping, no filtering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="haskell"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
</pre></td><td class="code"><pre><span class="c1">-- sum of product of maximum for every color for every line</span>
<span class="n">star2</span> <span class="o">::</span> <span class="kt">String</span> <span class="o">-&gt;</span> <span class="kt">Int</span>
<span class="n">star2</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">.</span> <span class="n">map</span> <span class="p">(</span><span class="n">prod'</span> <span class="o">.</span> <span class="n">maxByColor</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">.</span> <span class="n">words</span> <span class="o">.</span> <span class="n">snd</span> <span class="o">.</span> <span class="n">splitId</span><span class="p">)</span> <span class="o">.</span> <span class="n">lines</span>
  <span class="kr">where</span>
    <span class="n">prod'</span> <span class="o">::</span> <span class="p">(</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">Int</span><span class="p">,</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span>
    <span class="n">prod'</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">b</span>
    <span class="c1">-- essentially a foldl which consumes two elements (count and color) at once</span>
    <span class="n">maxByColor</span> <span class="o">::</span> <span class="p">(</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">Int</span><span class="p">,</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">Int</span><span class="p">,</span> <span class="kt">Int</span><span class="p">)</span>
    <span class="n">maxByColor</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="kt">[]</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">maxByColor</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="p">(</span><span class="n">n'</span> <span class="o">:</span> <span class="p">(</span><span class="n">c</span> <span class="o">:</span> <span class="kr">_</span><span class="p">)</span> <span class="o">:</span> <span class="n">xs</span><span class="p">)</span>
      <span class="o">|</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">'r'</span> <span class="o">=</span> <span class="n">maxByColor</span> <span class="p">(</span><span class="n">max</span> <span class="n">r</span> <span class="n">n</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="n">xs</span>
      <span class="o">|</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">'g'</span> <span class="o">=</span> <span class="n">maxByColor</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">max</span> <span class="n">g</span> <span class="n">n</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="n">xs</span>
      <span class="o">|</span> <span class="n">c</span> <span class="o">==</span> <span class="sc">'b'</span> <span class="o">=</span> <span class="n">maxByColor</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">max</span> <span class="n">b</span> <span class="n">n</span><span class="p">)</span> <span class="n">xs</span>
      <span class="kr">where</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">read</span> <span class="n">n'</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#top">Top</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sol-rust-2">Rust | Day 2: Cube Conundrum</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://rust-lang.org">Rust</a> solution to <a href="https://adventofcode.com/2023/day/2">AoC|2023|2</a>.</p>
</div>
<div class="sect2">
<h3 id="_input_2">Input</h3>
<div class="paragraph">
<p>As it is the case quite often, parsing the input was the biggest part of today&#8217;s puzzle. Maybe I should stop separate parsing the input and solving the challenge and just do it in one pass?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="code"><pre><span class="k">pub</span> <span class="k">mod</span> <span class="n">input</span> <span class="p">{</span>
    <span class="k">use</span> <span class="k">crate</span><span class="p">::</span><span class="n">SolT</span><span class="p">;</span>

    <span class="nd">#[derive(Debug)]</span>
    <span class="k">pub</span> <span class="k">struct</span> <span class="nf">PuzzleData</span><span class="p">(</span><span class="k">pub</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="p">[</span><span class="n">SolT</span><span class="p">;</span> <span class="mi">3</span><span class="p">]</span><span class="o">&gt;&gt;</span><span class="p">);</span>

    <span class="k">fn</span> <span class="nf">parse_draw</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="p">[</span><span class="n">SolT</span><span class="p">;</span> <span class="mi">3</span><span class="p">]</span> <span class="p">{</span>
        <span class="n">line</span><span class="nf">.split</span><span class="p">(</span><span class="s">", "</span><span class="p">)</span><span class="nf">.fold</span><span class="p">([</span><span class="mi">0</span><span class="p">;</span> <span class="mi">3</span><span class="p">],</span> <span class="p">|[</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span> <span class="n">color</span><span class="p">|</span> <span class="p">{</span>
            <span class="k">match</span> <span class="n">color</span>
                <span class="nf">.split_once</span><span class="p">(</span><span class="sc">' '</span><span class="p">)</span>
                <span class="nf">.map</span><span class="p">(|(</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">)|</span> <span class="p">(</span><span class="n">n</span><span class="py">.parse</span><span class="p">::</span><span class="o">&lt;</span><span class="n">SolT</span><span class="o">&gt;</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">(),</span> <span class="n">c</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="nf">Some</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="s">"red"</span><span class="p">))</span> <span class="k">=&gt;</span> <span class="p">[</span><span class="n">r</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span>
                <span class="nf">Some</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="s">"green"</span><span class="p">))</span> <span class="k">=&gt;</span> <span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span>
                <span class="nf">Some</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="s">"blue"</span><span class="p">))</span> <span class="k">=&gt;</span> <span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="n">n</span><span class="p">],</span>
                <span class="n">_</span> <span class="k">=&gt;</span> <span class="nd">panic!</span><span class="p">(</span><span class="s">"Unexpected draw."</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">})</span>
    <span class="p">}</span>

    <span class="k">fn</span> <span class="nf">parse_game</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="p">[</span><span class="n">SolT</span><span class="p">;</span> <span class="mi">3</span><span class="p">]</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="n">line</span><span class="nf">.split_once</span><span class="p">(</span><span class="s">": "</span><span class="p">)</span>
            <span class="nf">.unwrap</span><span class="p">()</span>
            <span class="na">.1</span>
            <span class="nf">.split</span><span class="p">(</span><span class="s">"; "</span><span class="p">)</span>
            <span class="nf">.map</span><span class="p">(</span><span class="n">parse_draw</span><span class="p">)</span>
            <span class="nf">.collect</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="p">:</span> <span class="nb">AsRef</span><span class="o">&lt;</span><span class="nb">str</span><span class="o">&gt;&gt;</span> <span class="nb">From</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="k">for</span> <span class="n">PuzzleData</span> <span class="p">{</span>
        <span class="k">fn</span> <span class="nf">from</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="k">Self</span> <span class="p">{</span>
            <span class="nf">PuzzleData</span><span class="p">(</span><span class="n">s</span><span class="nf">.as_ref</span><span class="p">()</span><span class="nf">.lines</span><span class="p">()</span><span class="nf">.map</span><span class="p">(</span><span class="n">parse_game</span><span class="p">)</span><span class="nf">.collect</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_star_1_4">Star 1</h3>
<div class="paragraph">
<p>iter (enumerated) &#8230;&#8203; filter &#8230;&#8203; map &#8230;&#8203; sum</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
</pre></td><td class="code"><pre><span class="k">pub</span> <span class="k">fn</span> <span class="nf">star_1</span><span class="p">(</span><span class="nf">PuzzleData</span><span class="p">(</span><span class="n">games</span><span class="p">):</span> <span class="o">&amp;</span><span class="n">PuzzleData</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="n">SolT</span> <span class="p">{</span>
    <span class="n">games</span>
        <span class="nf">.iter</span><span class="p">()</span>
        <span class="nf">.enumerate</span><span class="p">()</span>
        <span class="nf">.filter</span><span class="p">(|(</span><span class="n">_</span><span class="p">,</span> <span class="n">game</span><span class="p">)|</span> <span class="p">{</span>
            <span class="n">game</span><span class="nf">.iter</span><span class="p">()</span>
                <span class="nf">.all</span><span class="p">(|[</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">]|</span> <span class="o">*</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="mi">12</span> <span class="o">&amp;&amp;</span> <span class="o">*</span><span class="n">g</span> <span class="o">&lt;=</span> <span class="mi">13</span> <span class="o">&amp;&amp;</span> <span class="o">*</span><span class="n">b</span> <span class="o">&lt;=</span> <span class="mi">14</span><span class="p">)</span>
        <span class="p">})</span>
        <span class="nf">.map</span><span class="p">(|(</span><span class="n">pos</span><span class="p">,</span> <span class="n">_</span><span class="p">)|</span> <span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="nf">.sum</span><span class="p">()</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_star_2_4">Star 2</h3>
<div class="paragraph">
<p>iter &#8230;&#8203; map (nested iter &#8230;&#8203; fold) &#8230;&#8203; map &#8230;&#8203; sum</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
</pre></td><td class="code"><pre><span class="k">pub</span> <span class="k">fn</span> <span class="nf">star_2</span><span class="p">(</span><span class="nf">PuzzleData</span><span class="p">(</span><span class="n">games</span><span class="p">):</span> <span class="o">&amp;</span><span class="n">PuzzleData</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="n">SolT</span> <span class="p">{</span>
    <span class="n">games</span>
        <span class="nf">.iter</span><span class="p">()</span>
        <span class="nf">.map</span><span class="p">(|</span><span class="n">game</span><span class="p">|</span> <span class="p">{</span>
            <span class="n">game</span><span class="nf">.iter</span><span class="p">()</span>
                <span class="nf">.fold</span><span class="p">([</span><span class="mi">0</span><span class="p">;</span> <span class="mi">3</span><span class="p">],</span> <span class="p">|[</span><span class="n">r_max</span><span class="p">,</span> <span class="n">g_max</span><span class="p">,</span> <span class="n">b_max</span><span class="p">],</span> <span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">]|</span> <span class="p">{</span>
                    <span class="p">[</span><span class="n">r_max</span><span class="nf">.max</span><span class="p">(</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">g_max</span><span class="nf">.max</span><span class="p">(</span><span class="o">*</span><span class="n">g</span><span class="p">),</span> <span class="n">b_max</span><span class="nf">.max</span><span class="p">(</span><span class="o">*</span><span class="n">b</span><span class="p">)]</span>
                <span class="p">})</span>
        <span class="p">})</span>
        <span class="nf">.map</span><span class="p">(|[</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">]|</span> <span class="n">r</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>
        <span class="nf">.sum</span><span class="p">()</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tests_2">Tests</h3>
<div class="paragraph">
<p>I proudly announce: all tests passed the first time I executed (normally, I never miss any occasion to do stupid mistakes)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="code"><pre><span class="nd">#[cfg(test)]</span>
<span class="k">mod</span> <span class="n">tests</span> <span class="p">{</span>
    <span class="k">use</span> <span class="k">super</span><span class="p">::</span><span class="o">*</span><span class="p">;</span>

    <span class="k">const</span> <span class="n">CONTENT</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span> <span class="o">=</span> <span class="s">r#"Game 1: 3 blue, 4 red; 1 red, 2 green, 6 blue; 2 green
Game 2: 1 blue, 2 green; 3 green, 4 blue, 1 red; 1 green, 1 blue
Game 3: 8 green, 6 blue, 20 red; 5 blue, 4 red, 13 green; 5 green, 1 red
Game 4: 1 green, 3 red, 6 blue; 3 green, 6 red; 3 green, 15 blue, 14 red
Game 5: 6 red, 1 blue, 3 green; 2 blue, 1 red, 2 green
"#</span><span class="p">;</span>

    <span class="nd">#[test]</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_from</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="n">expected</span><span class="p">:</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="p">[</span><span class="n">SolT</span><span class="p">;</span> <span class="mi">3</span><span class="p">]</span><span class="o">&gt;&gt;</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span>
            <span class="nd">vec!</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
            <span class="nd">vec!</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
            <span class="nd">vec!</span><span class="p">[[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
            <span class="nd">vec!</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">]],</span>
            <span class="nd">vec!</span><span class="p">[[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
        <span class="p">];</span>
        <span class="k">let</span> <span class="nf">PuzzleData</span><span class="p">(</span><span class="n">games</span><span class="p">)</span> <span class="o">=</span> <span class="nn">PuzzleData</span><span class="p">::</span><span class="nf">from</span><span class="p">(</span><span class="n">CONTENT</span><span class="p">);</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">games</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">#[test]</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_star_1</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="nf">star_1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">CONTENT</span><span class="nf">.into</span><span class="p">()));</span>
    <span class="p">}</span>

    <span class="nd">#[test]</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_star_2</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="mi">2286</span><span class="p">,</span> <span class="nf">star_2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">CONTENT</span><span class="nf">.into</span><span class="p">()));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#top">Top</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sol-rust-3">Rust | Day 3: Gear Ratios</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://rust-lang.org">Rust</a> solution to <a href="https://adventofcode.com/2023/day/3">AoC|2023|3</a>.</p>
</div>
<div class="sect2">
<h3 id="_input_3">Input</h3>
<div class="paragraph">
<p>I just read the input bytes into a <code>Vec&lt;u8&gt;</code> and determine the width of the grid as the position of the first line break (<code>\n</code>)</p>
</div>
</div>
<div class="sect2">
<h3 id="_star_1_5">Star 1</h3>
<div class="paragraph">
<p>I created a helper function <code>numbers</code> that returns an iterator over all numbers in the input data with the help of the <code>next_number</code> function. Actually, the iterator returns a tuple with the number&#8217;s value, its position, and its length (number of digits).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="code"><pre><span class="k">pub</span> <span class="k">fn</span> <span class="nf">numbers</span><span class="p">(</span><span class="n">grid</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="nb">u8</span><span class="p">])</span> <span class="k">-&gt;</span> <span class="k">impl</span> <span class="nb">Iterator</span><span class="o">&lt;</span><span class="n">Item</span> <span class="o">=</span> <span class="p">(</span><span class="n">SolT</span><span class="p">,</span> <span class="nb">usize</span><span class="p">,</span> <span class="nb">usize</span><span class="p">)</span><span class="o">&gt;</span> <span class="o">+</span> <span class="nv">'_</span> <span class="p">{</span>
    <span class="nf">successors</span><span class="p">(</span><span class="nf">next_number</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">|(</span><span class="n">_</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">len</span><span class="p">)|</span> <span class="p">{</span>
        <span class="nf">next_number</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">len</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">}</span>

<span class="k">pub</span> <span class="k">fn</span> <span class="nf">next_number</span><span class="p">(</span><span class="n">grid</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="nb">u8</span><span class="p">],</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">usize</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="p">(</span><span class="n">SolT</span><span class="p">,</span> <span class="nb">usize</span><span class="p">,</span> <span class="nb">usize</span><span class="p">)</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="n">grid</span><span class="p">[</span><span class="n">offset</span><span class="o">..</span><span class="p">]</span>
        <span class="nf">.iter</span><span class="p">()</span>
        <span class="nf">.position</span><span class="p">(|</span><span class="n">b</span><span class="p">|</span> <span class="p">(</span><span class="sc">b'0'</span><span class="o">..=</span><span class="sc">b'9'</span><span class="p">)</span><span class="nf">.contains</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
        <span class="nf">.map</span><span class="p">(|</span><span class="n">pos</span><span class="p">|</span> <span class="p">{</span>
            <span class="n">grid</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">pos</span><span class="o">..</span><span class="p">]</span>
                <span class="nf">.iter</span><span class="p">()</span>
                <span class="nf">.take_while</span><span class="p">(|</span><span class="n">b</span><span class="p">|</span> <span class="p">(</span><span class="sc">b'0'</span><span class="o">..=</span><span class="sc">b'9'</span><span class="p">)</span><span class="nf">.contains</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
                <span class="nf">.fold</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">pos</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">|(</span><span class="n">val</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">len</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">|</span> <span class="p">{</span>
                    <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">val</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="sc">b'0'</span><span class="p">)</span> <span class="k">as</span> <span class="n">SolT</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="p">})</span>
        <span class="p">})</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>For every number, we need to check all adjacent positions in the input data, so I created another helper function <code>run_around</code>, which iterates over all valid adjacent positions (by chaining iterators looking above, to the right, below, and to the left):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="code"><pre><span class="k">pub</span> <span class="k">fn</span> <span class="nf">run_around</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span> <span class="nb">usize</span><span class="p">,</span> <span class="n">len</span><span class="p">:</span> <span class="nb">usize</span><span class="p">,</span> <span class="n">w</span><span class="p">:</span> <span class="nb">usize</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="nb">usize</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="k">impl</span> <span class="nb">Iterator</span><span class="o">&lt;</span><span class="n">Item</span> <span class="o">=</span> <span class="nb">usize</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">let</span> <span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span> <span class="o">%</span> <span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">pos</span> <span class="o">/</span> <span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>

    <span class="p">(</span><span class="n">col</span><span class="nf">.saturating_sub</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">..</span><span class="n">w</span><span class="nf">.min</span><span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="n">len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="nf">.filter</span><span class="p">(</span><span class="k">move</span> <span class="p">|</span><span class="n">_</span><span class="p">|</span> <span class="n">row</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nf">.map</span><span class="p">(</span><span class="k">move</span> <span class="p">|</span><span class="n">col</span><span class="p">|</span> <span class="n">col</span> <span class="o">+</span> <span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="nf">.chain</span><span class="p">(</span>
            <span class="nf">once</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="nf">.filter</span><span class="p">(</span><span class="k">move</span> <span class="p">|</span><span class="n">_</span><span class="p">|</span> <span class="n">col</span> <span class="o">+</span> <span class="n">len</span> <span class="o">&lt;</span> <span class="n">w</span><span class="p">)</span>
                <span class="nf">.map</span><span class="p">(</span><span class="k">move</span> <span class="p">|</span><span class="n">row</span><span class="p">|</span> <span class="n">col</span> <span class="o">+</span> <span class="n">len</span> <span class="o">+</span> <span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">row</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="nf">.chain</span><span class="p">(</span>
            <span class="p">(</span><span class="n">col</span><span class="nf">.saturating_sub</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">..</span><span class="n">w</span><span class="nf">.min</span><span class="p">(</span><span class="n">col</span> <span class="o">+</span> <span class="n">len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                <span class="nf">.rev</span><span class="p">()</span>
                <span class="nf">.filter</span><span class="p">(</span><span class="k">move</span> <span class="p">|</span><span class="n">_</span><span class="p">|</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">h</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="nf">.map</span><span class="p">(</span><span class="k">move</span> <span class="p">|</span><span class="n">col</span><span class="p">|</span> <span class="n">col</span> <span class="o">+</span> <span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)),</span>
        <span class="p">)</span>
        <span class="nf">.chain</span><span class="p">(</span>
            <span class="nf">once</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="nf">.filter</span><span class="p">(</span><span class="k">move</span> <span class="p">|</span><span class="n">_</span><span class="p">|</span> <span class="n">col</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
                <span class="nf">.map</span><span class="p">(</span><span class="k">move</span> <span class="p">|</span><span class="n">row</span><span class="p">|</span> <span class="n">col</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">row</span><span class="p">),</span>
        <span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>With those helpers in place, the solution for the first star is obtained by filtering out all numbers that are not adjacent to a symbol and summing their values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
</pre></td><td class="code"><pre><span class="k">pub</span> <span class="k">fn</span> <span class="nf">star_1</span><span class="p">(</span><span class="n">PuzzleData</span> <span class="p">{</span> <span class="n">grid</span><span class="p">,</span> <span class="n">w</span> <span class="p">}:</span> <span class="o">&amp;</span><span class="n">PuzzleData</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="n">SolT</span> <span class="p">{</span>
    <span class="nf">numbers</span><span class="p">(</span><span class="o">&amp;</span><span class="n">grid</span><span class="p">)</span>
        <span class="nf">.filter</span><span class="p">(|(</span><span class="n">_</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">len</span><span class="p">)|</span> <span class="p">{</span>
            <span class="nf">run_around</span><span class="p">(</span><span class="o">*</span><span class="n">pos</span><span class="p">,</span> <span class="o">*</span><span class="n">len</span><span class="p">,</span> <span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="n">grid</span><span class="nf">.len</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                <span class="nf">.map</span><span class="p">(|</span><span class="n">pos</span><span class="p">|</span> <span class="n">grid</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span>
                <span class="nf">.any</span><span class="p">(|</span><span class="n">b</span><span class="p">:</span> <span class="nb">u8</span><span class="p">|</span> <span class="n">b</span> <span class="o">!=</span> <span class="sc">b'.'</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="sc">b'0'</span><span class="o">..=</span><span class="sc">b'9'</span><span class="p">)</span><span class="nf">.contains</span><span class="p">(</span><span class="o">&amp;</span><span class="n">b</span><span class="p">))</span>
        <span class="p">})</span>
        <span class="nf">.map</span><span class="p">(|(</span><span class="n">value</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">)|</span> <span class="n">value</span><span class="p">)</span>
        <span class="nf">.sum</span><span class="p">()</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_star_2_5">Star 2</h3>
<div class="paragraph">
<p>The second star makes use of the same helper functions as the first star. I first iterate through all the numbers to create a map of the positions of the gear ratio symbols '*' to lists of adjacent numbers. Then I iterate through this map, filter out all entries that do not have exactly two numbers in the list, map to the product of those two numbers, and take the sum.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
</pre></td><td class="code"><pre><span class="k">pub</span> <span class="k">fn</span> <span class="nf">star_2</span><span class="p">(</span><span class="n">PuzzleData</span> <span class="p">{</span> <span class="n">grid</span><span class="p">,</span> <span class="n">w</span> <span class="p">}:</span> <span class="o">&amp;</span><span class="n">PuzzleData</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="n">SolT</span> <span class="p">{</span>
    <span class="nf">numbers</span><span class="p">(</span><span class="o">&amp;</span><span class="n">grid</span><span class="p">)</span>
        <span class="nf">.fold</span><span class="p">(</span><span class="nn">HashMap</span><span class="p">::</span><span class="nf">new</span><span class="p">(),</span> <span class="p">|</span><span class="n">map</span><span class="p">,</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">len</span><span class="p">)|</span> <span class="p">{</span>
            <span class="nf">run_around</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="n">grid</span><span class="nf">.len</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                <span class="nf">.filter</span><span class="p">(|</span><span class="o">&amp;</span><span class="n">pos</span><span class="p">|</span> <span class="n">grid</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="sc">b'*'</span><span class="p">)</span>
                <span class="nf">.fold</span><span class="p">(</span><span class="n">map</span><span class="p">,</span> <span class="p">|</span><span class="k">mut</span> <span class="n">map</span><span class="p">,</span> <span class="n">pos</span><span class="p">|</span> <span class="p">{</span>
                    <span class="n">map</span><span class="nf">.entry</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="nf">.or_insert</span><span class="p">(</span><span class="nn">Vec</span><span class="p">::</span><span class="nf">new</span><span class="p">())</span><span class="nf">.push</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
                    <span class="n">map</span>
                <span class="p">})</span>
        <span class="p">})</span>
        <span class="nf">.values</span><span class="p">()</span>
        <span class="nf">.filter</span><span class="p">(|</span><span class="n">values</span><span class="p">|</span> <span class="n">values</span><span class="nf">.len</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nf">.map</span><span class="p">(|</span><span class="n">values</span><span class="p">|</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nf">.sum</span><span class="p">()</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tests_3">Tests</h3>
<div class="paragraph">
<p>As usual.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre></td><td class="code"><pre><span class="nd">#[cfg(test)]</span>
<span class="k">mod</span> <span class="n">tests</span> <span class="p">{</span>
    <span class="k">use</span> <span class="k">super</span><span class="p">::</span><span class="o">*</span><span class="p">;</span>

    <span class="k">const</span> <span class="n">CONTENT</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span> <span class="o">=</span> <span class="s">r#"467..114..
...*......
..35..633.
......#...
617*......
.....+.58.
..592.....
......755.
...$.*....
.664.598..
"#</span><span class="p">;</span>

    <span class="nd">#[test]</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_from</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="n">data</span> <span class="o">=</span> <span class="nn">PuzzleData</span><span class="p">::</span><span class="nf">from</span><span class="p">(</span><span class="n">CONTENT</span><span class="nf">.as_bytes</span><span class="p">()</span><span class="nf">.to_vec</span><span class="p">());</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">data</span><span class="py">.w</span><span class="p">);</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="mi">110</span><span class="p">,</span> <span class="n">data</span><span class="py">.grid</span><span class="nf">.len</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="nd">#[test]</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_next_number</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="n">PuzzleData</span> <span class="p">{</span> <span class="n">grid</span><span class="p">,</span> <span class="n">w</span><span class="p">:</span> <span class="n">_w</span> <span class="p">}</span> <span class="o">=</span> <span class="nn">PuzzleData</span><span class="p">::</span><span class="nf">from</span><span class="p">(</span><span class="n">CONTENT</span><span class="nf">.as_bytes</span><span class="p">()</span><span class="nf">.to_vec</span><span class="p">());</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="nf">Some</span><span class="p">((</span><span class="mi">467</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="nf">next_number</span><span class="p">(</span><span class="o">&amp;</span><span class="n">grid</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="nf">Some</span><span class="p">((</span><span class="mi">35</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="nf">next_number</span><span class="p">(</span><span class="o">&amp;</span><span class="n">grid</span><span class="p">,</span> <span class="mi">10</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nd">#[test]</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_star_1</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="mi">4_361</span><span class="p">,</span> <span class="nf">star_1</span><span class="p">(</span><span class="o">&amp;</span><span class="n">CONTENT</span><span class="nf">.as_bytes</span><span class="p">()</span><span class="nf">.to_vec</span><span class="p">()</span><span class="nf">.into</span><span class="p">()));</span>
    <span class="p">}</span>

    <span class="nd">#[test]</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_star_2</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="mi">467_835</span><span class="p">,</span> <span class="nf">star_2</span><span class="p">(</span><span class="o">&amp;</span><span class="n">CONTENT</span><span class="nf">.as_bytes</span><span class="p">()</span><span class="nf">.to_vec</span><span class="p">()</span><span class="nf">.into</span><span class="p">()));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#top">Top</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sol-rust-4">Rust | Day 4: Scratchcards</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://rust-lang.org">Rust</a> solution to <a href="https://adventofcode.com/2023/day/4">AoC|2023|4</a>.</p>
</div>
<div class="sect2">
<h3 id="_input_4">Input</h3>
<div class="paragraph">
<p>Today, I directly operate on the input as <code>&amp;str</code>, no pre-processing.</p>
</div>
</div>
<div class="sect2">
<h3 id="_star_1_6">Star 1</h3>
<div class="paragraph">
<p>I build an iterator which yields for every line the number of items that appear in both lists on the scratch card using set intersection. Then I apply the scoring function to those numbers and take the sum:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="code"><pre><span class="k">pub</span> <span class="k">fn</span> <span class="nf">count_winners</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="k">impl</span> <span class="nb">Iterator</span><span class="o">&lt;</span><span class="n">Item</span> <span class="o">=</span> <span class="n">SolT</span><span class="o">&gt;</span> <span class="o">+</span> <span class="nv">'_</span> <span class="p">{</span>
    <span class="n">data</span><span class="nf">.lines</span><span class="p">()</span>
        <span class="nf">.map</span><span class="p">(|</span><span class="n">line</span><span class="p">|</span> <span class="n">line</span><span class="nf">.split_once</span><span class="p">(</span><span class="sc">':'</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">()</span><span class="na">.1</span><span class="nf">.split_once</span><span class="p">(</span><span class="s">" | "</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">())</span>
        <span class="nf">.map</span><span class="p">(|(</span><span class="n">w</span><span class="p">,</span> <span class="n">a</span><span class="p">)|</span> <span class="p">{</span>
            <span class="n">w</span><span class="nf">.split_ascii_whitespace</span><span class="p">()</span>
                <span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="n">HashSet</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">()</span>
                <span class="nf">.intersection</span><span class="p">(</span><span class="o">&amp;</span><span class="n">a</span><span class="nf">.split_ascii_whitespace</span><span class="p">()</span><span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="n">HashSet</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">())</span>
                <span class="nf">.count</span><span class="p">()</span>
        <span class="p">})</span>
<span class="p">}</span>

<span class="k">pub</span> <span class="k">fn</span> <span class="nf">star_1</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="n">SolT</span> <span class="p">{</span>
    <span class="nf">count_winners</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="nf">.map</span><span class="p">(|</span><span class="n">c</span><span class="p">|</span> <span class="k">match</span> <span class="n">c</span> <span class="p">{</span>
            <span class="mi">0</span> <span class="k">=&gt;</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">n</span> <span class="k">=&gt;</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">})</span>
        <span class="nf">.sum</span><span class="p">()</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_star_2_6">Star 2</h3>
<div class="paragraph">
<p>I pass through all cards once to update the number of subsequent cards (in a nested fold). Since the outer fold does not know the total number of cards, I need to initialize enough counters with <code>1</code> (initially, every card is available once).</p>
</div>
<div class="paragraph">
<p>A key statement from the puzzle description for the algorithm to work is "Cards will never make you copy a card past the end of the table."</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
</pre></td><td class="code"><pre><span class="k">pub</span> <span class="k">fn</span> <span class="nf">star_2</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="n">SolT</span> <span class="p">{</span>
    <span class="nf">count_winners</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="nf">.enumerate</span><span class="p">()</span>
        <span class="nf">.fold</span><span class="p">(</span><span class="nd">vec!</span><span class="p">[],</span> <span class="p">|</span><span class="k">mut</span> <span class="n">counts</span><span class="p">,</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">wins</span><span class="p">)|</span> <span class="p">{</span>
            <span class="n">counts</span><span class="nf">.resize</span><span class="p">(</span><span class="n">counts</span><span class="nf">.len</span><span class="p">()</span><span class="nf">.max</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="n">wins</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
            <span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="o">..=</span><span class="n">pos</span> <span class="o">+</span> <span class="n">wins</span><span class="p">)</span><span class="nf">.fold</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="p">|</span><span class="k">mut</span> <span class="n">counts</span><span class="p">,</span> <span class="n">pos_upd</span><span class="p">|</span> <span class="p">{</span>
                <span class="n">counts</span><span class="p">[</span><span class="n">pos_upd</span><span class="p">]</span> <span class="o">+=</span> <span class="n">counts</span><span class="p">[</span><span class="n">pos</span><span class="p">];</span>
                <span class="n">counts</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="nf">.iter</span><span class="p">()</span>
        <span class="nf">.sum</span><span class="p">()</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tests_4">Tests</h3>
<div class="paragraph">
<p>Nothing special here.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="rust"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="code"><pre><span class="nd">#[cfg(test)]</span>
<span class="k">mod</span> <span class="n">tests</span> <span class="p">{</span>
    <span class="k">use</span> <span class="k">super</span><span class="p">::</span><span class="o">*</span><span class="p">;</span>

    <span class="k">const</span> <span class="n">CONTENT</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span> <span class="o">=</span> <span class="s">r#"Card 1: 41 48 83 86 17 | 83 86  6 31 17  9 48 53
Card 2: 13 32 20 16 61 | 61 30 68 82 17 32 24 19
Card 3:  1 21 53 59 44 | 69 82 63 72 16 21 14  1
Card 4: 41 92 73 84 69 | 59 84 76 51 58  5 54 83
Card 5: 87 83 26 28 32 | 88 30 70 12 93 22 82 36
Card 6: 31 18 13 56 72 | 74 77 10 23 35 67 36 11
"#</span><span class="p">;</span>

    <span class="nd">#[test]</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_count_winners</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">assert_eq!</span><span class="p">(</span>
            <span class="nd">vec!</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="nf">count_winners</span><span class="p">(</span><span class="n">CONTENT</span><span class="p">)</span><span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">()</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">#[test]</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_star_1</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="nf">star_1</span><span class="p">(</span><span class="n">CONTENT</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nd">#[test]</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">test_star_2</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="nf">star_2</span><span class="p">(</span><span class="n">CONTENT</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#top">Top</a></p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
    <div id="footer-text">
        Generated from <a href="https://github.com/mr-kaffee/aoc-2023/">github.com/mr-kaffee/aoc-2023/</a> on 2023-12-04 06:08:31 UTC
        with <a href="https://asciidoctor.org">asciidoctor</a>.
    </div>
</div>
</body>
</html>